{"ast":null,"code":"import React from'react';import{Navigate}from'react-router-dom';import{useAuth}from'../context/AuthContext';/**\r\n * ProtectedRoute 组件 - 受保护的路由组件\r\n * \r\n * 功能：\r\n * 1. 保护需要认证才能访问的页面\r\n * 2. 支持基于用户角色的访问控制（普通用户 vs 管理员）\r\n * 3. 未认证用户自动重定向到登录页面\r\n * 4. 普通用户访问管理员页面时重定向到用户仪表板\r\n * \r\n * Props:\r\n * - children: 需要保护的子组件\r\n * - requireAdmin: 是否需要管理员权限（默认为 false）\r\n */import{jsx as _jsx}from\"react/jsx-runtime\";const ProtectedRoute=_ref=>{let{children,requireAdmin=false}=_ref;// 从认证上下文获取认证状态、用户信息和加载状态\nconst{isAuthenticated,userInfo,loading}=useAuth();// 调试日志\nconsole.log('ProtectedRoute - 是否需要管理员权限:',requireAdmin);console.log('ProtectedRoute - 用户信息:',userInfo);console.log('ProtectedRoute - 用户是否认证:',isAuthenticated);if(userInfo){console.log('ProtectedRoute - 用户是否为管理员:',Boolean(userInfo.isAdmin));}// 如果正在加载认证状态，显示加载指示器\nif(loading){return/*#__PURE__*/_jsx(\"div\",{className:\"flex justify-center items-center h-screen\",children:/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-500\",children:\"\\u52A0\\u8F7D\\u4E2D...\"})});}// 如果用户未认证，重定向到登录页面\nif(!isAuthenticated){console.log('ProtectedRoute - 用户未认证，重定向到登录页面');return/*#__PURE__*/_jsx(Navigate,{to:\"/auth\"});}// 如果需要管理员权限但用户不是管理员，重定向到用户仪表板\nif(requireAdmin&&!userInfo.isAdmin){console.log('ProtectedRoute - 用户不是管理员，重定向到用户仪表板');return/*#__PURE__*/_jsx(Navigate,{to:\"/user-dashboard\"});}// 所有检查通过，渲染受保护的子组件\nconsole.log('ProtectedRoute - 所有检查通过，渲染子组件');return children;};export default ProtectedRoute;","map":{"version":3,"names":["React","Navigate","useAuth","jsx","_jsx","ProtectedRoute","_ref","children","requireAdmin","isAuthenticated","userInfo","loading","console","log","Boolean","isAdmin","className","to"],"sources":["D:/软件工程/智慧海洋牧场可视化系统/frontend/src/components/ProtectedRoute.js"],"sourcesContent":["import React from 'react';\r\nimport { Navigate } from 'react-router-dom';\r\nimport { useAuth } from '../context/AuthContext';\r\n\r\n/**\r\n * ProtectedRoute 组件 - 受保护的路由组件\r\n * \r\n * 功能：\r\n * 1. 保护需要认证才能访问的页面\r\n * 2. 支持基于用户角色的访问控制（普通用户 vs 管理员）\r\n * 3. 未认证用户自动重定向到登录页面\r\n * 4. 普通用户访问管理员页面时重定向到用户仪表板\r\n * \r\n * Props:\r\n * - children: 需要保护的子组件\r\n * - requireAdmin: 是否需要管理员权限（默认为 false）\r\n */\r\nconst ProtectedRoute = ({ children, requireAdmin = false }) => {\r\n  // 从认证上下文获取认证状态、用户信息和加载状态\r\n  const { isAuthenticated, userInfo, loading } = useAuth();\r\n\r\n  // 调试日志\r\n  console.log('ProtectedRoute - 是否需要管理员权限:', requireAdmin);\r\n  console.log('ProtectedRoute - 用户信息:', userInfo);\r\n  console.log('ProtectedRoute - 用户是否认证:', isAuthenticated);\r\n  if (userInfo) {\r\n    console.log('ProtectedRoute - 用户是否为管理员:', Boolean(userInfo.isAdmin));\r\n  }\r\n\r\n  // 如果正在加载认证状态，显示加载指示器\r\n  if (loading) {\r\n    return (\r\n      <div className=\"flex justify-center items-center h-screen\">\r\n        <p className=\"text-gray-500\">加载中...</p>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  // 如果用户未认证，重定向到登录页面\r\n  if (!isAuthenticated) {\r\n    console.log('ProtectedRoute - 用户未认证，重定向到登录页面');\r\n    return <Navigate to=\"/auth\" />;\r\n  }\r\n  \r\n  // 如果需要管理员权限但用户不是管理员，重定向到用户仪表板\r\n  if (requireAdmin && !userInfo.isAdmin) {\r\n    console.log('ProtectedRoute - 用户不是管理员，重定向到用户仪表板');\r\n    return <Navigate to=\"/user-dashboard\" />;\r\n  }\r\n\r\n  // 所有检查通过，渲染受保护的子组件\r\n  console.log('ProtectedRoute - 所有检查通过，渲染子组件');\r\n  return children;\r\n};\r\n\r\nexport default ProtectedRoute;"],"mappings":"AAAA,MAAO,CAAAA,KAAK,KAAM,OAAO,CACzB,OAASC,QAAQ,KAAQ,kBAAkB,CAC3C,OAASC,OAAO,KAAQ,wBAAwB,CAEhD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAZA,OAAAC,GAAA,IAAAC,IAAA,yBAaA,KAAM,CAAAC,cAAc,CAAGC,IAAA,EAAwC,IAAvC,CAAEC,QAAQ,CAAEC,YAAY,CAAG,KAAM,CAAC,CAAAF,IAAA,CACxD;AACA,KAAM,CAAEG,eAAe,CAAEC,QAAQ,CAAEC,OAAQ,CAAC,CAAGT,OAAO,CAAC,CAAC,CAExD;AACAU,OAAO,CAACC,GAAG,CAAC,6BAA6B,CAAEL,YAAY,CAAC,CACxDI,OAAO,CAACC,GAAG,CAAC,wBAAwB,CAAEH,QAAQ,CAAC,CAC/CE,OAAO,CAACC,GAAG,CAAC,0BAA0B,CAAEJ,eAAe,CAAC,CACxD,GAAIC,QAAQ,CAAE,CACZE,OAAO,CAACC,GAAG,CAAC,4BAA4B,CAAEC,OAAO,CAACJ,QAAQ,CAACK,OAAO,CAAC,CAAC,CACtE,CAEA;AACA,GAAIJ,OAAO,CAAE,CACX,mBACEP,IAAA,QAAKY,SAAS,CAAC,2CAA2C,CAAAT,QAAA,cACxDH,IAAA,MAAGY,SAAS,CAAC,eAAe,CAAAT,QAAA,CAAC,uBAAM,CAAG,CAAC,CACpC,CAAC,CAEV,CAEA;AACA,GAAI,CAACE,eAAe,CAAE,CACpBG,OAAO,CAACC,GAAG,CAAC,iCAAiC,CAAC,CAC9C,mBAAOT,IAAA,CAACH,QAAQ,EAACgB,EAAE,CAAC,OAAO,CAAE,CAAC,CAChC,CAEA;AACA,GAAIT,YAAY,EAAI,CAACE,QAAQ,CAACK,OAAO,CAAE,CACrCH,OAAO,CAACC,GAAG,CAAC,oCAAoC,CAAC,CACjD,mBAAOT,IAAA,CAACH,QAAQ,EAACgB,EAAE,CAAC,iBAAiB,CAAE,CAAC,CAC1C,CAEA;AACAL,OAAO,CAACC,GAAG,CAAC,+BAA+B,CAAC,CAC5C,MAAO,CAAAN,QAAQ,CACjB,CAAC,CAED,cAAe,CAAAF,cAAc","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}