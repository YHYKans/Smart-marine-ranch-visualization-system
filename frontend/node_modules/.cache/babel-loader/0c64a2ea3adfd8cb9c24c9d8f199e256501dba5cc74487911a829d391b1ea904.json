{"ast":null,"code":"import{useState,useEffect,useRef}from'react';import ReactMarkdown from'react-markdown';import{motion}from'framer-motion';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";function ChatPage(){const[messages,setMessages]=useState([]);const[input,setInput]=useState('');const[isLoading,setIsLoading]=useState(false);const[error,setError]=useState(null);const messagesEndRef=useRef(null);const messageContainerRef=useRef(null);useEffect(()=>{if(messagesEndRef.current){messagesEndRef.current.scrollIntoView({behavior:'smooth'});}},[messages]);const handleInputChange=e=>{setInput(e.target.value);};const getStreamingResponse=async(message,messageId)=>{try{const response=await fetch('http://localhost:3001/api/chat',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({message})});if(!response.ok){throw new Error(`HTTP error! status: ${response.status}`);}const reader=response.body.getReader();const decoder=new TextDecoder('utf-8');let buffer='';while(true){const{done,value}=await reader.read();if(done){break;}buffer+=decoder.decode(value,{stream:true});const lines=buffer.split('\\n\\n');buffer=lines.pop()||'';for(const line of lines){if(line.startsWith('data: ')){try{const data=JSON.parse(line.slice(6));setMessages(prev=>prev.map(msg=>msg.id===messageId?{...msg,content:msg.content+(data.content||''),...(data.finished?{isStreaming:false}:{})}:msg));if(data.error){throw new Error(data.error);}}catch(e){console.error('Error parsing SSE data:',e);}}}}setMessages(prev=>prev.map(msg=>msg.id===messageId?{...msg,isStreaming:false}:msg));}catch(error){console.error('Error in streaming response:',error);setMessages(prev=>prev.map(msg=>msg.id===messageId?{...msg,content:msg.content+'\\n\\n[连接中断] '+error.message,isStreaming:false}:msg));}};const simulateStreamingResponse=async(message,messageId)=>{try{const words=`这是一个模拟回应。目前无法连接到后端服务器，所以显示这条测试消息。您的问题是关于: \"${message}\"。请确保后端服务器正在运行，并且可以从前端访问API端点 /api/chat。`;const wordArray=words.split(' ');for(let i=0;i<wordArray.length;i++){setMessages(prev=>prev.map(msg=>msg.id===messageId?{...msg,content:msg.content+(i>0?' ':'')+wordArray[i],...(i===wordArray.length-1?{isStreaming:false}:{})}:msg));await new Promise(resolve=>setTimeout(resolve,50));}}catch(error){console.error('Error in simulation:',error);setMessages(prev=>prev.map(msg=>msg.id===messageId?{...msg,content:'获取回应时出错',isStreaming:false}:msg));}};const handleSubmit=async e=>{if(e)e.preventDefault();if(!input.trim()||isLoading)return;const userMessage={role:'user',content:input,timestamp:new Date().toLocaleTimeString()};setMessages(prev=>[...prev,userMessage]);setInput('');setIsLoading(true);setError(null);try{const aiMessageId=Date.now();setMessages(prev=>[...prev,{id:aiMessageId,role:'assistant',content:'',timestamp:new Date().toLocaleTimeString(),isStreaming:true}]);try{await getStreamingResponse(userMessage.content,aiMessageId);}catch(apiError){console.warn('无法连接到后端API，使用模拟模式:',apiError);await simulateStreamingResponse(userMessage.content,aiMessageId);}}catch(err){setError('连接服务器失败，请稍后再试');console.error('Error:',err);}finally{setIsLoading(false);}};const handleKeyDown=e=>{if(e.key==='Enter'&&!e.shiftKey){e.preventDefault();handleSubmit();}};// 自定义 Markdown 渲染组件\nconst MarkdownRenderer=_ref=>{let{content}=_ref;return/*#__PURE__*/_jsx(\"div\",{className:\"prose prose-invert prose-cyan max-w-none\",children:/*#__PURE__*/_jsx(ReactMarkdown,{components:{a:_ref2=>{let{node,...props}=_ref2;return/*#__PURE__*/_jsx(\"a\",{...props,className:\"text-cyan-400 hover:text-cyan-300\"});},code:_ref3=>{let{node,...props}=_ref3;return/*#__PURE__*/_jsx(\"code\",{...props,className:\"bg-cyan-900/50 px-1 py-0.5 rounded\"});},pre:_ref4=>{let{node,...props}=_ref4;return/*#__PURE__*/_jsx(\"pre\",{...props,className:\"bg-[rgba(10,25,47,0.8)] border border-cyan-500/30 rounded-lg p-4 overflow-x-auto\"});}},children:content})});};// 海洋背景动画元素\nconst renderOceanElements=()=>{return/*#__PURE__*/_jsxs(_Fragment,{children:[[...Array(20)].map((_,i)=>/*#__PURE__*/_jsx(\"div\",{className:\"absolute rounded-full animate-pulse\",style:{top:`${Math.random()*100}%`,left:`${Math.random()*100}%`,width:`${Math.random()*10+2}px`,height:`${Math.random()*10+2}px`,backgroundColor:i%3===0?'#00FFFF':i%3===1?'#00BFFF':'#1E90FF',opacity:Math.random()*0.5+0.2,animationDuration:`${Math.random()*5+3}s`,zIndex:0}},i)),/*#__PURE__*/_jsx(\"div\",{className:\"absolute bottom-0 left-0 w-full overflow-hidden z-0\",children:/*#__PURE__*/_jsxs(\"svg\",{className:\"relative block w-[calc(100%+1.3px)] h-[80px]\",\"data-name\":\"Layer 1\",xmlns:\"http://www.w3.org/2000/svg\",viewBox:\"0 0 1200 120\",preserveAspectRatio:\"none\",children:[/*#__PURE__*/_jsx(\"path\",{d:\"M0,0V46.29c47.79,22.2,103.59,32.17,158,28,70.36-5.37,136.33-33.31,206.8-37.5C438.64,32.43,512.34,53.67,583,72.05c69.27,18,138.3,24.88,209.4,13.08,36.15-6,69.85-17.84,104.45-29.34C989.49,25,1113-14.29,1200,52.47V0Z\",className:\"fill-current text-blue-500 opacity-30\"}),/*#__PURE__*/_jsx(\"path\",{d:\"M0,0V15.81C13,36.92,27.64,56.86,47.69,72.05,99.41,111.27,165,111,224.58,91.58c31.15-10.15,60.09-26.07,89.67-39.8,40.92-19,84.73-46,130.83-49.67,36.26-2.85,70.9,9.42,98.6,31.56,31.77,25.39,62.32,62,103.63,73,40.44,10.79,81.35-6.69,119.13-24.28s75.16-39,116.92-43.05c59.73-5.85,113.28,22.88,168.9,38.84,30.2,8.66,59,6.17,87.09-7.5,22.43-10.89,48-26.93,60.65-49.24V0Z\",className:\"fill-current text-teal-400 opacity-40\"}),/*#__PURE__*/_jsx(\"path\",{d:\"M0,0V5.63C149.93,59,314.09,71.32,475.83,42.57c43-7.64,84.23-20.12,127.61-26.46,59-8.63,112.48,12.24,165.56,35.4C827.93,77.22,886,95.24,951.2,90c86.53-7,172.46-45.71,248.8-84.81V0Z\",className:\"fill-current text-cyan-300 opacity-30\"})]})})]});};// 示例问题\nconst exampleQuestions=[\"海洋养殖中如何控制水质？\",\"深海网箱养殖的最佳实践是什么？\",\"如何预防海洋养殖中的疾病传播？\",\"AI在海洋养殖中有哪些创新应用？\"];return/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-col h-screen bg-gradient-to-br from-[#0a192f] via-[#0c2a4a] to-[#0a3d62] overflow-hidden\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"absolute inset-0 z-0 overflow-hidden\",children:renderOceanElements()}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-[rgba(10,25,47,0.8)] backdrop-blur-md border-b border-cyan-500/30 p-4 flex items-center justify-between z-10\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"bg-cyan-500/10 p-2 rounded-full border border-cyan-400/30 mr-3\",children:/*#__PURE__*/_jsx(\"div\",{className:\"text-xl text-cyan-400\",children:\"\\uD83C\\uDF0A\"})}),/*#__PURE__*/_jsx(\"h1\",{className:\"text-xl font-bold text-white\",children:\"\\u667A\\u6167\\u6D77\\u6D0B\\u7267\\u573A AI \\u52A9\\u624B\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"text-cyan-300 text-sm\",children:\"\\u667A\\u80FD\\u5BF9\\u8BDD \\xB7 \\u6D77\\u6D0B\\u517B\\u6B96 \\xB7 \\u6570\\u636E\\u5206\\u6790\"})]}),/*#__PURE__*/_jsx(\"div\",{ref:messageContainerRef,className:\"flex-1 p-6 overflow-y-auto relative z-10\",children:messages.length===0?/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-col items-center justify-center h-full text-center z-10 relative\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"bg-cyan-500/10 p-6 rounded-full border border-cyan-400/30 mb-6\",children:/*#__PURE__*/_jsx(\"div\",{className:\"text-6xl text-cyan-400\",children:\"\\uD83C\\uDF0A\"})}),/*#__PURE__*/_jsx(\"h2\",{className:\"text-3xl font-bold text-white mb-3\",children:\"\\u6B22\\u8FCE\\u4F7F\\u7528\\u667A\\u6167\\u6D77\\u6D0B\\u7267\\u573A AI \\u52A9\\u624B\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-cyan-200 max-w-lg mb-8\",children:\"\\u6211\\u662F\\u60A8\\u7684\\u6D77\\u6D0B\\u517B\\u6B96\\u667A\\u80FD\\u52A9\\u624B\\uFF0C\\u53EF\\u4EE5\\u56DE\\u7B54\\u5173\\u4E8E\\u6D77\\u6D0B\\u7267\\u573A\\u5EFA\\u8BBE\\u3001\\u517B\\u6B96\\u6280\\u672F\\u3001\\u73AF\\u5883\\u76D1\\u6D4B\\u7B49\\u4E13\\u4E1A\\u95EE\\u9898\"}),/*#__PURE__*/_jsx(\"div\",{className:\"grid grid-cols-2 gap-4 max-w-lg w-full\",children:exampleQuestions.map((question,index)=>/*#__PURE__*/_jsxs(motion.div,{className:\"bg-[rgba(10,25,47,0.7)] border border-cyan-500/30 rounded-xl p-4 text-left cursor-pointer hover:bg-[rgba(10,25,47,0.9)] transition-colors\",whileHover:{y:-5},whileTap:{scale:0.98},onClick:()=>{setInput(question);setTimeout(()=>handleSubmit(),100);},children:[/*#__PURE__*/_jsx(\"div\",{className:\"text-cyan-400 text-lg mb-2\",children:[\"📊\",\"🐟\",\"📈\",\"🤖\"][index]}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-cyan-200\",children:question})]},index))})]}):/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-4 max-w-4xl mx-auto\",children:[messages.map((message,index)=>/*#__PURE__*/_jsx(motion.div,{className:`flex ${message.role==='user'?'justify-end':'justify-start'}`,initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:0.3},children:/*#__PURE__*/_jsxs(\"div\",{className:`max-w-3/4 rounded-2xl p-4 relative overflow-hidden ${message.role==='user'?'bg-gradient-to-r from-cyan-600 to-blue-700 text-white':'bg-[rgba(255,255,255,0.1)] backdrop-blur-sm border border-cyan-500/30 text-white'}`,children:[message.role==='assistant'&&/*#__PURE__*/_jsx(\"div\",{className:\"absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-transparent via-cyan-400 to-transparent\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-start\",children:[message.role==='assistant'&&/*#__PURE__*/_jsx(\"div\",{className:\"bg-cyan-500/20 p-2 rounded-full mr-3\",children:/*#__PURE__*/_jsx(\"div\",{className:\"text-cyan-300\",children:\"\\uD83E\\uDD16\"})}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex-1\",children:[message.role==='user'?/*#__PURE__*/_jsx(\"div\",{className:\"whitespace-pre-wrap\",children:message.content}):/*#__PURE__*/_jsx(MarkdownRenderer,{content:message.content}),message.isStreaming&&/*#__PURE__*/_jsx(\"div\",{className:\"mt-2\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex space-x-1\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"h-2 w-2 bg-cyan-400 rounded-full animate-bounce\",style:{animationDelay:'-0.32s'}}),/*#__PURE__*/_jsx(\"div\",{className:\"h-2 w-2 bg-cyan-400 rounded-full animate-bounce\",style:{animationDelay:'-0.16s'}}),/*#__PURE__*/_jsx(\"div\",{className:\"h-2 w-2 bg-cyan-400 rounded-full animate-bounce\"})]})}),/*#__PURE__*/_jsxs(\"div\",{className:`text-xs mt-2 ${message.role==='user'?'text-blue-200':'text-cyan-300'}`,children:[message.role==='user'?'用户':'海洋AI助手',\" \\xB7 \",message.timestamp]})]}),message.role==='user'&&/*#__PURE__*/_jsx(\"div\",{className:\"bg-blue-600/30 p-2 rounded-full ml-3\",children:/*#__PURE__*/_jsx(\"div\",{className:\"text-blue-200\",children:\"\\uD83D\\uDC64\"})})]})]})},index)),/*#__PURE__*/_jsx(\"div\",{ref:messagesEndRef})]})}),error&&/*#__PURE__*/_jsx(\"div\",{className:\"bg-red-500/20 border border-red-500/40 text-red-300 px-4 py-3 rounded-lg mx-6 mb-4 max-w-4xl mx-auto z-10 relative\",children:/*#__PURE__*/_jsx(\"p\",{children:error})}),/*#__PURE__*/_jsx(\"div\",{className:\"border-t border-cyan-500/30 p-4 bg-[rgba(10,25,47,0.8)] backdrop-blur-md z-10\",children:/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,className:\"max-w-4xl mx-auto\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex space-x-3 items-end\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex-1 relative\",children:[/*#__PURE__*/_jsx(\"textarea\",{value:input,onChange:handleInputChange,onKeyDown:handleKeyDown,disabled:isLoading,placeholder:\"\\u8BF7\\u8F93\\u5165\\u5173\\u4E8E\\u6D77\\u6D0B\\u517B\\u6B96\\u7684\\u95EE\\u9898...\",rows:1,className:\"w-full border border-cyan-500/50 bg-[rgba(10,40,70,0.5)] text-white rounded-2xl px-4 py-3 pr-12 focus:outline-none focus:ring-2 focus:ring-cyan-500 resize-none\",style:{minHeight:'56px'}}),/*#__PURE__*/_jsx(\"div\",{className:\"absolute right-3 bottom-3 text-cyan-400/70 text-sm\",children:\"Shift + Enter \\u6362\\u884C\"})]}),/*#__PURE__*/_jsx(motion.button,{type:\"submit\",disabled:isLoading||!input.trim(),className:`h-14 w-14 flex items-center justify-center rounded-full ${isLoading||!input.trim()?'bg-gray-600 text-gray-500 cursor-not-allowed':'bg-gradient-to-r from-cyan-500 to-blue-600 text-white hover:from-cyan-600 hover:to-blue-700'} transition-all`,whileHover:{scale:isLoading||!input.trim()?1:1.05},whileTap:{scale:isLoading||!input.trim()?1:0.95},children:isLoading?/*#__PURE__*/_jsxs(\"div\",{className:\"flex space-x-1\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"h-2 w-2 bg-white rounded-full animate-bounce\",style:{animationDelay:'-0.32s'}}),/*#__PURE__*/_jsx(\"div\",{className:\"h-2 w-2 bg-white rounded-full animate-bounce\",style:{animationDelay:'-0.16s'}}),/*#__PURE__*/_jsx(\"div\",{className:\"h-2 w-2 bg-white rounded-full animate-bounce\"})]}):/*#__PURE__*/_jsx(\"svg\",{xmlns:\"http://www.w3.org/2000/svg\",viewBox:\"0 0 24 24\",fill:\"currentColor\",className:\"w-6 h-6\",children:/*#__PURE__*/_jsx(\"path\",{d:\"M3.478 2.404a.75.75 0 0 0-.926.941l2.432 7.905H13.5a.75.75 0 0 1 0 1.5H4.984l-2.432 7.905a.75.75 0 0 0 .926.94 60.519 60.519 0 0 0 18.445-8.986.75.75 0 0 0 0-1.218A60.517 60.517 0 0 0 3.478 2.404Z\"})})})]}),/*#__PURE__*/_jsx(\"div\",{className:\"mt-3 flex justify-center\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"text-xs text-cyan-400/70 flex items-center\",children:[/*#__PURE__*/_jsx(\"svg\",{xmlns:\"http://www.w3.org/2000/svg\",viewBox:\"0 0 24 24\",fill:\"currentColor\",className:\"w-4 h-4 mr-1\",children:/*#__PURE__*/_jsx(\"path\",{fillRule:\"evenodd\",d:\"M2.25 12c0-5.385 4.365-9.75 9.75-9.75s9.75 4.365 9.75 9.75-4.365 9.75-9.75 9.75S2.25 17.385 2.25 12Zm8.706-1.442c1.146-.573 2.437.463 2.126 1.706l-.709 2.836.042-.02a.75.75 0 0 1 .67 1.34l-.04.022c-1.147.573-2.438-.463-2.127-1.706l.71-2.836-.042.02a.75.75 0 1 1-.671-1.34l.041-.022ZM12 9a.75.75 0 1 0 0-1.5.75.75 0 0 0 0 1.5Z\",clipRule:\"evenodd\"})}),\"\\u667A\\u6167\\u6D77\\u6D0B\\u7267\\u573A AI \\u52A9\\u624B \\xB7 \\u63D0\\u4F9B\\u4E13\\u4E1A\\u6D77\\u6D0B\\u517B\\u6B96\\u54A8\\u8BE2\"]})})]})}),/*#__PURE__*/_jsx(\"style\",{jsx:true,children:`\n        @keyframes fadeIn {\n          from { opacity: 0; }\n          to { opacity: 1; }\n        }\n        \n        @keyframes fadeInUp {\n          from { \n            opacity: 0;\n            transform: translateY(20px);\n          }\n          to { \n            opacity: 1;\n            transform: translateY(0);\n          }\n        }\n        \n        @keyframes wiggle {\n          0%, 100% { transform: rotate(0deg); }\n          25% { transform: rotate(5deg); }\n          50% { transform: rotate(-5deg); }\n          75% { transform: rotate(5deg); }\n        }\n        \n        .animate-wiggle {\n          animation: wiggle 8s infinite;\n        }\n        \n        .animate-bounce {\n          animation: bounce 1.5s infinite;\n        }\n        \n        @keyframes bounce {\n          0%, 100% { transform: translateY(0); }\n          50% { transform: translateY(-5px); }\n        }\n      `})]});}export default ChatPage;","map":{"version":3,"names":["useState","useEffect","useRef","ReactMarkdown","motion","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","ChatPage","messages","setMessages","input","setInput","isLoading","setIsLoading","error","setError","messagesEndRef","messageContainerRef","current","scrollIntoView","behavior","handleInputChange","e","target","value","getStreamingResponse","message","messageId","response","fetch","method","headers","body","JSON","stringify","ok","Error","status","reader","getReader","decoder","TextDecoder","buffer","done","read","decode","stream","lines","split","pop","line","startsWith","data","parse","slice","prev","map","msg","id","content","finished","isStreaming","console","simulateStreamingResponse","words","wordArray","i","length","Promise","resolve","setTimeout","handleSubmit","preventDefault","trim","userMessage","role","timestamp","Date","toLocaleTimeString","aiMessageId","now","apiError","warn","err","handleKeyDown","key","shiftKey","MarkdownRenderer","_ref","className","children","components","a","_ref2","node","props","code","_ref3","pre","_ref4","renderOceanElements","Array","_","style","top","Math","random","left","width","height","backgroundColor","opacity","animationDuration","zIndex","xmlns","viewBox","preserveAspectRatio","d","exampleQuestions","ref","question","index","div","whileHover","y","whileTap","scale","onClick","initial","animate","transition","duration","animationDelay","onSubmit","onChange","onKeyDown","disabled","placeholder","rows","minHeight","button","type","fill","fillRule","clipRule"],"sources":["D:/软件工程/智慧海洋牧场可视化系统/frontend/src/pages/ChatPage.js"],"sourcesContent":["import { useState, useEffect, useRef } from 'react';\r\nimport ReactMarkdown from 'react-markdown';\r\nimport { motion } from 'framer-motion';\r\n\r\nfunction ChatPage() {\r\n  const [messages, setMessages] = useState([]);\r\n  const [input, setInput] = useState('');\r\n  const [isLoading, setIsLoading] = useState(false);\r\n  const [error, setError] = useState(null);\r\n  \r\n  const messagesEndRef = useRef(null);\r\n  const messageContainerRef = useRef(null);\r\n  \r\n  useEffect(() => {\r\n    if (messagesEndRef.current) {\r\n      messagesEndRef.current.scrollIntoView({ behavior: 'smooth' });\r\n    }\r\n  }, [messages]);\r\n  \r\n  const handleInputChange = (e) => {\r\n    setInput(e.target.value);\r\n  };\r\n  \r\n  const getStreamingResponse = async (message, messageId) => {\r\n    try {\r\n      const response = await fetch('http://localhost:3001/api/chat', {\r\n        method: 'POST',\r\n        headers: {\r\n          'Content-Type': 'application/json',\r\n        },\r\n        body: JSON.stringify({ message }),\r\n      });\r\n      \r\n      if (!response.ok) {\r\n        throw new Error(`HTTP error! status: ${response.status}`);\r\n      }\r\n      \r\n      const reader = response.body.getReader();\r\n      const decoder = new TextDecoder('utf-8');\r\n      let buffer = '';\r\n      \r\n      while (true) {\r\n        const { done, value } = await reader.read();\r\n        \r\n        if (done) {\r\n          break;\r\n        }\r\n        \r\n        buffer += decoder.decode(value, { stream: true });\r\n        \r\n        const lines = buffer.split('\\n\\n');\r\n        buffer = lines.pop() || '';\r\n        \r\n        for (const line of lines) {\r\n          if (line.startsWith('data: ')) {\r\n            try {\r\n              const data = JSON.parse(line.slice(6));\r\n              \r\n              setMessages(prev => \r\n                prev.map(msg => \r\n                  msg.id === messageId \r\n                    ? { \r\n                        ...msg, \r\n                        content: msg.content + (data.content || ''),\r\n                        ...(data.finished ? { isStreaming: false } : {})\r\n                      } \r\n                    : msg\r\n                )\r\n              );\r\n              \r\n              if (data.error) {\r\n                throw new Error(data.error);\r\n              }\r\n            } catch (e) {\r\n              console.error('Error parsing SSE data:', e);\r\n            }\r\n          }\r\n        }\r\n      }\r\n      \r\n      setMessages(prev => \r\n        prev.map(msg => \r\n          msg.id === messageId \r\n            ? { ...msg, isStreaming: false } \r\n            : msg\r\n        )\r\n      );\r\n      \r\n    } catch (error) {\r\n      console.error('Error in streaming response:', error);\r\n      setMessages(prev => \r\n        prev.map(msg => \r\n          msg.id === messageId \r\n            ? { ...msg, content: msg.content + '\\n\\n[连接中断] ' + error.message, isStreaming: false } \r\n            : msg\r\n        )\r\n      );\r\n    }\r\n  };\r\n  \r\n  const simulateStreamingResponse = async (message, messageId) => {\r\n    try {\r\n      const words = `这是一个模拟回应。目前无法连接到后端服务器，所以显示这条测试消息。您的问题是关于: \"${message}\"。请确保后端服务器正在运行，并且可以从前端访问API端点 /api/chat。`;\r\n      const wordArray = words.split(' ');\r\n      \r\n      for (let i = 0; i < wordArray.length; i++) {\r\n        setMessages(prev => \r\n          prev.map(msg => \r\n            msg.id === messageId \r\n              ? { \r\n                  ...msg, \r\n                  content: msg.content + (i > 0 ? ' ' : '') + wordArray[i],\r\n                  ...(i === wordArray.length - 1 ? { isStreaming: false } : {})\r\n                } \r\n              : msg\r\n          )\r\n        );\r\n        \r\n        await new Promise(resolve => setTimeout(resolve, 50));\r\n      }\r\n    } catch (error) {\r\n      console.error('Error in simulation:', error);\r\n      setMessages(prev => \r\n        prev.map(msg => \r\n          msg.id === messageId \r\n            ? { ...msg, content: '获取回应时出错', isStreaming: false } \r\n            : msg\r\n        )\r\n      );\r\n    }\r\n  };\r\n  \r\n  const handleSubmit = async (e) => {\r\n    if (e) e.preventDefault();\r\n    \r\n    if (!input.trim() || isLoading) return;\r\n    \r\n    const userMessage = {\r\n      role: 'user',\r\n      content: input,\r\n      timestamp: new Date().toLocaleTimeString()\r\n    };\r\n    \r\n    setMessages(prev => [...prev, userMessage]);\r\n    setInput('');\r\n    setIsLoading(true);\r\n    setError(null);\r\n    \r\n    try {\r\n      const aiMessageId = Date.now();\r\n      setMessages(prev => [...prev, {\r\n        id: aiMessageId,\r\n        role: 'assistant',\r\n        content: '',\r\n        timestamp: new Date().toLocaleTimeString(),\r\n        isStreaming: true\r\n      }]);\r\n      \r\n      try {\r\n        await getStreamingResponse(userMessage.content, aiMessageId);\r\n      } catch (apiError) {\r\n        console.warn('无法连接到后端API，使用模拟模式:', apiError);\r\n        await simulateStreamingResponse(userMessage.content, aiMessageId);\r\n      }\r\n      \r\n    } catch (err) {\r\n      setError('连接服务器失败，请稍后再试');\r\n      console.error('Error:', err);\r\n    } finally {\r\n      setIsLoading(false);\r\n    }\r\n  };\r\n  \r\n  const handleKeyDown = (e) => {\r\n    if (e.key === 'Enter' && !e.shiftKey) {\r\n      e.preventDefault();\r\n      handleSubmit();\r\n    }\r\n  };\r\n  \r\n  // 自定义 Markdown 渲染组件\r\n  const MarkdownRenderer = ({ content }) => {\r\n    return (\r\n      <div className=\"prose prose-invert prose-cyan max-w-none\">\r\n        <ReactMarkdown\r\n          components={{\r\n            a: ({ node, ...props }) => (\r\n              <a {...props} className=\"text-cyan-400 hover:text-cyan-300\" />\r\n            ),\r\n            code: ({ node, ...props }) => (\r\n              <code {...props} className=\"bg-cyan-900/50 px-1 py-0.5 rounded\" />\r\n            ),\r\n            pre: ({ node, ...props }) => (\r\n              <pre \r\n                {...props} \r\n                className=\"bg-[rgba(10,25,47,0.8)] border border-cyan-500/30 rounded-lg p-4 overflow-x-auto\" \r\n              />\r\n            )\r\n          }}\r\n        >\r\n          {content}\r\n        </ReactMarkdown>\r\n      </div>\r\n    );\r\n  };\r\n  \r\n  // 海洋背景动画元素\r\n  const renderOceanElements = () => {\r\n    return (\r\n      <>\r\n        {[...Array(20)].map((_, i) => (\r\n          <div \r\n            key={i}\r\n            className=\"absolute rounded-full animate-pulse\"\r\n            style={{\r\n              top: `${Math.random() * 100}%`,\r\n              left: `${Math.random() * 100}%`,\r\n              width: `${Math.random() * 10 + 2}px`,\r\n              height: `${Math.random() * 10 + 2}px`,\r\n              backgroundColor: i % 3 === 0 \r\n                ? '#00FFFF' \r\n                : i % 3 === 1 \r\n                  ? '#00BFFF' \r\n                  : '#1E90FF',\r\n              opacity: Math.random() * 0.5 + 0.2,\r\n              animationDuration: `${Math.random() * 5 + 3}s`,\r\n              zIndex: 0\r\n            }}\r\n          />\r\n        ))}\r\n        \r\n        <div className=\"absolute bottom-0 left-0 w-full overflow-hidden z-0\">\r\n          <svg \r\n            className=\"relative block w-[calc(100%+1.3px)] h-[80px]\"\r\n            data-name=\"Layer 1\" \r\n            xmlns=\"http://www.w3.org/2000/svg\" \r\n            viewBox=\"0 0 1200 120\" \r\n            preserveAspectRatio=\"none\"\r\n          >\r\n            <path \r\n              d=\"M0,0V46.29c47.79,22.2,103.59,32.17,158,28,70.36-5.37,136.33-33.31,206.8-37.5C438.64,32.43,512.34,53.67,583,72.05c69.27,18,138.3,24.88,209.4,13.08,36.15-6,69.85-17.84,104.45-29.34C989.49,25,1113-14.29,1200,52.47V0Z\" \r\n              className=\"fill-current text-blue-500 opacity-30\" \r\n            ></path>\r\n            <path \r\n              d=\"M0,0V15.81C13,36.92,27.64,56.86,47.69,72.05,99.41,111.27,165,111,224.58,91.58c31.15-10.15,60.09-26.07,89.67-39.8,40.92-19,84.73-46,130.83-49.67,36.26-2.85,70.9,9.42,98.6,31.56,31.77,25.39,62.32,62,103.63,73,40.44,10.79,81.35-6.69,119.13-24.28s75.16-39,116.92-43.05c59.73-5.85,113.28,22.88,168.9,38.84,30.2,8.66,59,6.17,87.09-7.5,22.43-10.89,48-26.93,60.65-49.24V0Z\" \r\n              className=\"fill-current text-teal-400 opacity-40\" \r\n            ></path>\r\n            <path \r\n              d=\"M0,0V5.63C149.93,59,314.09,71.32,475.83,42.57c43-7.64,84.23-20.12,127.61-26.46,59-8.63,112.48,12.24,165.56,35.4C827.93,77.22,886,95.24,951.2,90c86.53-7,172.46-45.71,248.8-84.81V0Z\" \r\n              className=\"fill-current text-cyan-300 opacity-30\" \r\n            ></path>\r\n          </svg>\r\n        </div>\r\n      </>\r\n    );\r\n  };\r\n  \r\n  // 示例问题\r\n  const exampleQuestions = [\r\n    \"海洋养殖中如何控制水质？\",\r\n    \"深海网箱养殖的最佳实践是什么？\",\r\n    \"如何预防海洋养殖中的疾病传播？\",\r\n    \"AI在海洋养殖中有哪些创新应用？\"\r\n  ];\r\n  \r\n  return (\r\n    <div className=\"flex flex-col h-screen bg-gradient-to-br from-[#0a192f] via-[#0c2a4a] to-[#0a3d62] overflow-hidden\">\r\n      {/* 背景动画元素 */}\r\n      <div className=\"absolute inset-0 z-0 overflow-hidden\">\r\n        {renderOceanElements()}\r\n      </div>\r\n      \r\n      {/* 顶部导航栏 */}\r\n      <div className=\"bg-[rgba(10,25,47,0.8)] backdrop-blur-md border-b border-cyan-500/30 p-4 flex items-center justify-between z-10\">\r\n        <div className=\"flex items-center\">\r\n          <div className=\"bg-cyan-500/10 p-2 rounded-full border border-cyan-400/30 mr-3\">\r\n            <div className=\"text-xl text-cyan-400\">🌊</div>\r\n          </div>\r\n          <h1 className=\"text-xl font-bold text-white\">智慧海洋牧场 AI 助手</h1>\r\n        </div>\r\n        <div className=\"text-cyan-300 text-sm\">\r\n          智能对话 · 海洋养殖 · 数据分析\r\n        </div>\r\n      </div>\r\n      \r\n      {/* 聊天消息区域 */}\r\n      <div \r\n        ref={messageContainerRef}\r\n        className=\"flex-1 p-6 overflow-y-auto relative z-10\"\r\n      >\r\n        {messages.length === 0 ? (\r\n          <div className=\"flex flex-col items-center justify-center h-full text-center z-10 relative\">\r\n            <div className=\"bg-cyan-500/10 p-6 rounded-full border border-cyan-400/30 mb-6\">\r\n              <div className=\"text-6xl text-cyan-400\">🌊</div>\r\n            </div>\r\n            <h2 className=\"text-3xl font-bold text-white mb-3\">欢迎使用智慧海洋牧场 AI 助手</h2>\r\n            <p className=\"text-cyan-200 max-w-lg mb-8\">\r\n              我是您的海洋养殖智能助手，可以回答关于海洋牧场建设、养殖技术、环境监测等专业问题\r\n            </p>\r\n            \r\n            <div className=\"grid grid-cols-2 gap-4 max-w-lg w-full\">\r\n              {exampleQuestions.map((question, index) => (\r\n                <motion.div \r\n                  key={index}\r\n                  className=\"bg-[rgba(10,25,47,0.7)] border border-cyan-500/30 rounded-xl p-4 text-left cursor-pointer hover:bg-[rgba(10,25,47,0.9)] transition-colors\"\r\n                  whileHover={{ y: -5 }}\r\n                  whileTap={{ scale: 0.98 }}\r\n                  onClick={() => {\r\n                    setInput(question);\r\n                    setTimeout(() => handleSubmit(), 100);\r\n                  }}\r\n                >\r\n                  <div className=\"text-cyan-400 text-lg mb-2\">{[\"📊\", \"🐟\", \"📈\", \"🤖\"][index]}</div>\r\n                  <p className=\"text-sm text-cyan-200\">{question}</p>\r\n                </motion.div>\r\n              ))}\r\n            </div>\r\n          </div>\r\n        ) : (\r\n          <div className=\"space-y-4 max-w-4xl mx-auto\">\r\n            {messages.map((message, index) => (\r\n              <motion.div \r\n                key={index}\r\n                className={`flex ${message.role === 'user' ? 'justify-end' : 'justify-start'}`}\r\n                initial={{ opacity: 0, y: 20 }}\r\n                animate={{ opacity: 1, y: 0 }}\r\n                transition={{ duration: 0.3 }}\r\n              >\r\n                <div \r\n                  className={`max-w-3/4 rounded-2xl p-4 relative overflow-hidden ${\r\n                    message.role === 'user' \r\n                      ? 'bg-gradient-to-r from-cyan-600 to-blue-700 text-white' \r\n                      : 'bg-[rgba(255,255,255,0.1)] backdrop-blur-sm border border-cyan-500/30 text-white'\r\n                  }`}\r\n                >\r\n                  {/* 消息装饰效果 */}\r\n                  {message.role === 'assistant' && (\r\n                    <div className=\"absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-transparent via-cyan-400 to-transparent\"></div>\r\n                  )}\r\n                  \r\n                  <div className=\"flex items-start\">\r\n                    {message.role === 'assistant' && (\r\n                      <div className=\"bg-cyan-500/20 p-2 rounded-full mr-3\">\r\n                        <div className=\"text-cyan-300\">🤖</div>\r\n                      </div>\r\n                    )}\r\n                    \r\n                    <div className=\"flex-1\">\r\n                      {message.role === 'user' ? (\r\n                        <div className=\"whitespace-pre-wrap\">{message.content}</div>\r\n                      ) : (\r\n                        <MarkdownRenderer content={message.content} />\r\n                      )}\r\n                      \r\n                      {message.isStreaming && (\r\n                        <div className=\"mt-2\">\r\n                          <div className=\"flex space-x-1\">\r\n                            <div className=\"h-2 w-2 bg-cyan-400 rounded-full animate-bounce\" style={{animationDelay: '-0.32s'}}></div>\r\n                            <div className=\"h-2 w-2 bg-cyan-400 rounded-full animate-bounce\" style={{animationDelay: '-0.16s'}}></div>\r\n                            <div className=\"h-2 w-2 bg-cyan-400 rounded-full animate-bounce\"></div>\r\n                          </div>\r\n                        </div>\r\n                      )}\r\n                      \r\n                      <div className={`text-xs mt-2 ${message.role === 'user' ? 'text-blue-200' : 'text-cyan-300'}`}>\r\n                        {message.role === 'user' ? '用户' : '海洋AI助手'} · {message.timestamp}\r\n                      </div>\r\n                    </div>\r\n                    \r\n                    {message.role === 'user' && (\r\n                      <div className=\"bg-blue-600/30 p-2 rounded-full ml-3\">\r\n                        <div className=\"text-blue-200\">👤</div>\r\n                      </div>\r\n                    )}\r\n                  </div>\r\n                </div>\r\n              </motion.div>\r\n            ))}\r\n            <div ref={messagesEndRef} />\r\n          </div>\r\n        )}\r\n      </div>\r\n      \r\n      {error && (\r\n        <div className=\"bg-red-500/20 border border-red-500/40 text-red-300 px-4 py-3 rounded-lg mx-6 mb-4 max-w-4xl mx-auto z-10 relative\">\r\n          <p>{error}</p>\r\n        </div>\r\n      )}\r\n      \r\n      <div className=\"border-t border-cyan-500/30 p-4 bg-[rgba(10,25,47,0.8)] backdrop-blur-md z-10\">\r\n        <form onSubmit={handleSubmit} className=\"max-w-4xl mx-auto\">\r\n          <div className=\"flex space-x-3 items-end\">\r\n            <div className=\"flex-1 relative\">\r\n              <textarea\r\n                value={input}\r\n                onChange={handleInputChange}\r\n                onKeyDown={handleKeyDown}\r\n                disabled={isLoading}\r\n                placeholder=\"请输入关于海洋养殖的问题...\"\r\n                rows={1}\r\n                className=\"w-full border border-cyan-500/50 bg-[rgba(10,40,70,0.5)] text-white rounded-2xl px-4 py-3 pr-12 focus:outline-none focus:ring-2 focus:ring-cyan-500 resize-none\"\r\n                style={{ minHeight: '56px' }}\r\n              />\r\n              <div className=\"absolute right-3 bottom-3 text-cyan-400/70 text-sm\">\r\n                Shift + Enter 换行\r\n              </div>\r\n            </div>\r\n            <motion.button\r\n              type=\"submit\"\r\n              disabled={isLoading || !input.trim()}\r\n              className={`h-14 w-14 flex items-center justify-center rounded-full ${\r\n                isLoading || !input.trim()\r\n                  ? 'bg-gray-600 text-gray-500 cursor-not-allowed'\r\n                  : 'bg-gradient-to-r from-cyan-500 to-blue-600 text-white hover:from-cyan-600 hover:to-blue-700'\r\n              } transition-all`}\r\n              whileHover={{ scale: isLoading || !input.trim() ? 1 : 1.05 }}\r\n              whileTap={{ scale: isLoading || !input.trim() ? 1 : 0.95 }}\r\n            >\r\n              {isLoading ? (\r\n                <div className=\"flex space-x-1\">\r\n                  <div className=\"h-2 w-2 bg-white rounded-full animate-bounce\" style={{animationDelay: '-0.32s'}}></div>\r\n                  <div className=\"h-2 w-2 bg-white rounded-full animate-bounce\" style={{animationDelay: '-0.16s'}}></div>\r\n                  <div className=\"h-2 w-2 bg-white rounded-full animate-bounce\"></div>\r\n                </div>\r\n              ) : (\r\n                <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\" fill=\"currentColor\" className=\"w-6 h-6\">\r\n                  <path d=\"M3.478 2.404a.75.75 0 0 0-.926.941l2.432 7.905H13.5a.75.75 0 0 1 0 1.5H4.984l-2.432 7.905a.75.75 0 0 0 .926.94 60.519 60.519 0 0 0 18.445-8.986.75.75 0 0 0 0-1.218A60.517 60.517 0 0 0 3.478 2.404Z\" />\r\n                </svg>\r\n              )}\r\n            </motion.button>\r\n          </div>\r\n          <div className=\"mt-3 flex justify-center\">\r\n            <div className=\"text-xs text-cyan-400/70 flex items-center\">\r\n              <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\" fill=\"currentColor\" className=\"w-4 h-4 mr-1\">\r\n                <path fillRule=\"evenodd\" d=\"M2.25 12c0-5.385 4.365-9.75 9.75-9.75s9.75 4.365 9.75 9.75-4.365 9.75-9.75 9.75S2.25 17.385 2.25 12Zm8.706-1.442c1.146-.573 2.437.463 2.126 1.706l-.709 2.836.042-.02a.75.75 0 0 1 .67 1.34l-.04.022c-1.147.573-2.438-.463-2.127-1.706l.71-2.836-.042.02a.75.75 0 1 1-.671-1.34l.041-.022ZM12 9a.75.75 0 1 0 0-1.5.75.75 0 0 0 0 1.5Z\" clipRule=\"evenodd\" />\r\n              </svg>\r\n              智慧海洋牧场 AI 助手 · 提供专业海洋养殖咨询\r\n            </div>\r\n          </div>\r\n        </form>\r\n      </div>\r\n      \r\n      {/* 全局动画样式 */}\r\n      <style jsx>{`\r\n        @keyframes fadeIn {\r\n          from { opacity: 0; }\r\n          to { opacity: 1; }\r\n        }\r\n        \r\n        @keyframes fadeInUp {\r\n          from { \r\n            opacity: 0;\r\n            transform: translateY(20px);\r\n          }\r\n          to { \r\n            opacity: 1;\r\n            transform: translateY(0);\r\n          }\r\n        }\r\n        \r\n        @keyframes wiggle {\r\n          0%, 100% { transform: rotate(0deg); }\r\n          25% { transform: rotate(5deg); }\r\n          50% { transform: rotate(-5deg); }\r\n          75% { transform: rotate(5deg); }\r\n        }\r\n        \r\n        .animate-wiggle {\r\n          animation: wiggle 8s infinite;\r\n        }\r\n        \r\n        .animate-bounce {\r\n          animation: bounce 1.5s infinite;\r\n        }\r\n        \r\n        @keyframes bounce {\r\n          0%, 100% { transform: translateY(0); }\r\n          50% { transform: translateY(-5px); }\r\n        }\r\n      `}</style>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default ChatPage;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}